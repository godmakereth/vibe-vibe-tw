---
title: "3.6.3 修正策略：怎麼讓 AI 改對"
---

# 3.6.3 修正策略：怎麼讓 AI 改對

## 經過本節學習，你將掌握

- 四種修正策略及其適用場景
- 「錯誤驅動開發」的工作流程
- 識別「死亡螺旋」的信號並及時止損
- 獲得一套可直接使用的修正 Prompt 模板

## 四種修正策略

在 3.5.3 中，我們學瞭如何給 AI 有效的反饋。本節聚焦於**問題已經發生後**的修正策略——當 AI 給的代碼有問題時，如何引導它改對。

| 策略 | 適用場景 | 核心思路 |
|-----|---------|---------|
| 精確指出問題 | 你知道具體哪裏錯了 | 給出位置 + 問題 + 期望 |
| 給出正確示例 | 格式或結構不對 | 展示正確的「樣子」 |
| 分步重做 | 任務太複雜導致出錯 | 拆解後逐個完成 |
| 換種問法 | 同一問法反覆失敗 | 改變描述角度或方式 |

### 策略一：精確指出問題

**適用場景**：你能定位到具體是哪行代碼、哪個函數有問題。

**Prompt 模板**：

```markdown
你在 [位置] 的代碼有問題：

**問題**：[描述具體問題]

**當前行爲**：[代碼現在做了什麼]

**期望行爲**：[代碼應該做什麼]

請修正這個問題，其他部分保持不變。
```

**示例**：

```markdown
你在 handleSubmit 函數第 15 行的代碼有問題：

**問題**：使用了 localStorage，但這是服務端渲染項目

**當前行爲**：直接調用 localStorage.setItem()，在服務端會報錯

**期望行爲**：先檢查是否在瀏覽器環境，或者使用 cookies

請修正這個問題，其他部分保持不變。
```

### 策略二：給出正確示例

**適用場景**：AI 理解了任務，但輸出的格式、結構不符合你的要求。

**Prompt 模板**：

```markdown
輸出格式不對。

**當前格式**：
[展示 AI 給的格式]

**期望格式**：
[展示你想要的格式]

請按期望格式重新輸出。
```

**示例**：

```markdown
函數返回格式不對。

**當前格式**：
直接返回數據，如 `return userData`

**期望格式**：
統一返回格式 `{ success: boolean, data: any, error?: string }`
成功時：`{ success: true, data: userData }`
失敗時：`{ success: false, data: null, error: "錯誤信息" }`

請按期望格式修改所有 API 函數的返回值。
```

### 策略三：分步重做

**適用場景**：任務太複雜，AI 一次性輸出的代碼問題較多，修補不如重來。

**Prompt 模板**：

```markdown
這個功能我們分步驟來做。

**第一步（當前）**：[最小核心功能]
只需要實現這一個功能，其他的後面再加。

完成後我會確認，然後我們再做第二步。
```

**示例**：

```markdown
用戶認證功能我們分步驟來做。

**第一步（當前）**：只實現用戶註冊
- 郵箱 + 密碼錶單
- 基本的格式驗證
- 存儲到數據庫

不需要：登錄、找回密碼、郵箱驗證、JWT

完成後我會確認，然後我們再做登錄功能。
```

### 策略四：換種問法

**適用場景**：同一個問題，用同樣的方式問了兩三次，AI 還是給出類似的錯誤答案。

**可以嘗試的角度轉換**：

| 原問法 | 換種問法 |
|-------|---------|
| 直接要結果 | 先問原理，再讓 AI 基於原理實現 |
| 用技術術語 | 用生活化語言描述需求 |
| 描述「要什麼」 | 描述「解決什麼問題」 |
| 從功能角度問 | 從用戶角度描述場景 |

**示例**：

```markdown
原問法（反覆失敗）：
"寫一個防抖函數"

換種問法：
"用戶在搜索框輸入時，我不想每敲一個字就觸發搜索請求，
而是希望用戶停止輸入 300 毫秒後再發起請求。
請幫我實現這個延遲觸發的邏輯。"
```

## 錯誤驅動開發：把 AI 變成調試助手

當你遇到錯誤時，不必自己分析——可以直接把錯誤信息扔給 AI，讓它幫你定位和修復。

### 工作流程

```
發現錯誤 → 複製完整錯誤信息 → 給 AI 分析 → 應用修復 → 驗證 → 如有新錯誤則重複
```

### 操作模板

```markdown
運行代碼時遇到以下錯誤：

```
[粘貼完整的錯誤信息]
```

相關代碼：
```[語言]
[粘貼相關代碼片段]
```

請分析錯誤原因，並給出修復方案。
```

### 示例

```markdown
運行代碼時遇到以下錯誤：

```
TypeError: Cannot read properties of undefined (reading 'map')
    at UserList (UserList.jsx:12:23)
```

相關代碼：
```jsx
function UserList({ users }) {
  return (
    <ul>
      {users.map(user => <li key={user.id}>{user.name}</li>)}
    </ul>
  );
}
```

請分析錯誤原因，並給出修復方案。
```

**AI 通常會告訴你**：
- 錯誤原因：`users` 可能是 `undefined`
- 修復方案：添加空值檢查或默認值

## 警惕「死亡螺旋」

「死亡螺旋」是指：你讓 AI 修問題，它修了一個又引入兩個新問題；你再讓它修，問題越來越多，代碼越來越亂。

### 識別信號

- 🚨 修改輪次超過 3 次，問題還沒解決
- 🚨 AI 的代碼量越改越多、越改越複雜
- 🚨 修了 A 問題，B 功能又壞了
- 🚨 AI 開始「繞圈」，給出的方案和之前類似

### 止損策略

一旦識別到死亡螺旋，果斷止損：

**選項 1：回退重來**
```markdown
這個方向走不通。請忘掉之前的修改，我們從頭開始。

[重新清晰地描述需求，可能需要拆分成更小的任務]
```

**選項 2：保留能用的，手動修復剩餘部分**
```markdown
請把目前能正常工作的代碼整理一下給我，
有問題的部分用註釋標註出來，我自己來修。
```

**選項 3：換一個 AI 工具試試**

不同的 AI 模型在不同任務上表現不同。如果一個工具反覆卡住，換一個試試可能會有驚喜。

## 修正 Prompt 模板庫

### 修復運行時錯誤

```markdown
這段代碼報錯了：

錯誤信息：
```
[錯誤信息]
```

代碼：
```[語言]
[代碼]
```

請修復這個錯誤。如果需要更多上下文，請告訴我需要什麼信息。
```

### 修復邏輯錯誤

```markdown
這段代碼可以運行，但結果不對：

**輸入**：[描述輸入]
**期望輸出**：[描述期望結果]
**實際輸出**：[描述實際結果]

代碼：
```[語言]
[代碼]
```

請找出邏輯問題並修復。
```

### 修復樣式問題

```markdown
樣式和預期不符：

**期望效果**：[描述或截圖鏈接]
**實際效果**：[描述當前問題]

當前代碼：
```css
[樣式代碼]
```

請修改樣式使其符合期望效果。
```

### 要求 AI 自查

```markdown
請檢查上面的代碼：

1. 有哪些潛在的邊界情況沒有處理？
2. 有哪些可能導致運行時錯誤的地方？
3. 有哪些可以優化的地方？

列出問題後，請給出修復後的完整代碼。
```

## 本節要點

✓ **四種修正策略**：精確指出 → 給出示例 → 分步重做 → 換種問法

✓ **錯誤驅動開發**：把錯誤信息直接扔給 AI，讓它幫你定位和修復

✓ **警惕死亡螺旋**：修改超過 3 輪還沒解決，果斷止損重來

✓ **模板庫**：積累常用的修正 Prompt，提高修復效率

但有時候，問題不在於怎麼修正，而是 AI 真的做不到。下一節我們來看兜底策略——當 AI 真的搞不定時該怎麼辦。
