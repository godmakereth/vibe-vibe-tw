---
title: "0.7.2 給集裝箱貼上標籤——環境變量配置"
typora-root-url: ../../public
---

# 0.7.2 給集裝箱貼上標籤——Docker 環境變量配置

## 一句話破題

容器的配置應通過環境變量注入。把“環境與密鑰”從鏡像中剝離，做到鏡像通用、部署可配。

## 基礎用法：--env 與 --env-file

```powershell
$env:API_BASE = 'https://api.example.com'
docker run -d --name app -p 3000:3000 --env API_BASE=$env:API_BASE myapp:latest
```

使用文件批量注入：

`.env.app`

```
API_BASE=https://api.example.com
DB_URL=postgres://user:pass@host:5432/db
```

```powershell
docker run -d --name app -p 3000:3000 --env-file .env.app myapp:latest
```

## Compose 中的環境變量

`.env`

```
API_BASE=https://api.example.com
DB_URL=postgres://user:pass@host:5432/db
```

`docker-compose.yml`

```yaml
version: '3.9'
services:
  app:
    image: myapp:latest
    ports:
      - "3000:3000"
    environment:
      - API_BASE=${API_BASE}
      - DB_URL=${DB_URL}
```

## 覺知：安全與可維護

- 不把密鑰寫入鏡像或代碼；統一從環境變量或密鑰服務注入。
- 本地開發用 `.env.local`，團隊共享用 `.env.development`（不含密鑰）。
- 生產通過密鑰管理服務注入；`.env.production` 不含明文密鑰。

## AI 協作指南

- 核心意圖：讓 AI 輸出“環境變量規範與注入方案”。
- 需求定義公式：
  - “爲應用設計環境變量注入方案，包含 `--env-file` 與 Compose 的 `.env`，並給出 PowerShell 命令。”
