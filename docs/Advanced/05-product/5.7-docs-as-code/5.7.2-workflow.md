---
title: "5.7.2 改了代碼必須改文檔——PR 流程：代碼變更必須同步文檔更新"
typora-root-url: ../../public
---

# 5.7.2 改了代碼必須改文檔——PR 流程

### 一句話破題

最好的文檔更新時機是**改代碼的時候**，而不是"以後再補"。

### 代碼與文檔同步更新

```mermaid
graph LR
    A["修改代碼"] --> B["同時修改文檔"]
    B --> C["同一個 commit"]
    C --> D["同一個 PR"]
    D --> E["一起 review"]
    E --> F["一起合併"]
```

### 什麼時候需要更新文檔

| 代碼變更類型 | 需要更新的文檔 |
|--------------|----------------|
| 新增 API 接口 | API 文檔 |
| 修改接口參數 | API 文檔 |
| 添加新功能 | 使用指南 |
| 修改配置方式 | 部署文檔 |
| 修改數據庫結構 | 架構文檔 |

### PR 提交規範

包含文檔更新的 commit 信息：

```bash
# 功能開發 + 文檔
feat: 添加文章搜索功能

- 實現關鍵詞搜索 API
- 添加搜索結果分頁
- 更新 API 文檔

# 修復 Bug + 文檔
fix: 修復登錄超時問題

- 延長 token 有效期
- 更新認證文檔說明

# 單獨文檔更新
docs: 更新部署文檔

- 添加 Docker 部署說明
- 修正環境變量配置
```

### PR 檢查清單

在提交 PR 前，檢查：

```markdown
## PR 檢查清單

### 代碼
- [ ] 代碼能正常運行
- [ ] 通過所有測試
- [ ] 沒有 lint 錯誤

### 文檔
- [ ] API 變更是否更新了 docs/api.md
- [ ] 新功能是否添加了使用說明
- [ ] 配置變更是否更新了 README
- [ ] 數據庫變更是否更新了架構文檔
```

### 獨立開發者的簡化流程

一個人開發時，流程可以簡化：

```mermaid
graph LR
    A["寫代碼"] --> B["寫文檔"]
    B --> C["commit"]
    C --> D["push"]
```

關鍵是養成習慣：
- 每次改代碼問自己："這個改動需要更新文檔嗎？"
- 如果需要，**立刻**更新，不要拖延

### 文檔更新的最佳時機

```
❌ 不好的做法
1. 寫完所有代碼
2. 項目要上線了
3. 想起來還沒寫文檔
4. 補文檔（已經忘了很多細節）

✅ 好的做法
1. 寫 API 代碼
2. 立刻寫 API 文檔
3. commit: "feat: 添加用戶註冊接口"
4. 繼續下一個功能
```

### 讓 AI 幫你寫文檔

```
你：我剛寫了一個用戶登錄 API，幫我寫文檔

POST /api/auth/login
參數：email, password
返回：user 對象和 token

AI：## POST /api/auth/login

用戶登錄接口。

### 請求參數

| 參數 | 類型 | 必填 | 說明 |
|------|------|------|------|
| email | string | 是 | 用戶郵箱 |
| password | string | 是 | 用戶密碼 |

### 成功響應

\`\`\`json
{
  "user": {
    "id": "user_123",
    "email": "user@example.com",
    "name": "張三"
  },
  "token": "eyJhbGciOiJIUzI1NiIs..."
}
\`\`\`

### 錯誤響應

| 狀態碼 | 錯誤碼 | 說明 |
|--------|--------|------|
| 400 | MISSING_EMAIL | 郵箱不能爲空 |
| 401 | INVALID_CREDENTIALS | 郵箱或密碼錯誤 |
```

### 實用建議

1. **代碼和文檔同一個 commit**：保證版本對應
2. **不要拖延**：寫完代碼立刻寫文檔
3. **用 AI 加速**：讓 AI 生成文檔草稿
4. **簡潔爲上**：文檔夠用就行，不必過度詳細
