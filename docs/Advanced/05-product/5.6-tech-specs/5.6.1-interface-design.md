---
title: "5.6.1 程序如何互相調用——接口設計：RESTful API 規範與約定"
typora-root-url: ../../public
---

# 5.6.1 程序如何互相調用——接口設計

### 一句話破題

接口設計就是定義**前後端如何對話**：誰發起、說什麼、怎麼回應。

### RESTful API 基礎

REST 是一種設計風格，核心思想是**把一切當作資源**：

| HTTP 方法 | 含義 | 示例 |
|-----------|------|------|
| GET | 獲取資源 | GET /posts - 獲取文章列表 |
| POST | 創建資源 | POST /posts - 創建文章 |
| PUT | 更新資源（全量） | PUT /posts/1 - 更新文章 |
| PATCH | 更新資源（部分） | PATCH /posts/1 - 部分更新 |
| DELETE | 刪除資源 | DELETE /posts/1 - 刪除文章 |

### 接口設計模板

```markdown
## POST /api/posts

### 功能描述
創建新文章

### 請求參數
| 字段 | 類型 | 必填 | 說明 |
|------|------|------|------|
| title | string | 是 | 文章標題，1-100 字符 |
| content | string | 是 | 文章內容，Markdown 格式 |
| categoryId | string | 是 | 分類 ID |
| tags | string[] | 否 | 標籤數組，最多 5 個 |

### 請求示例
```json
{
  "title": "我的第一篇文章",
  "content": "# Hello\n這是內容",
  "categoryId": "cat_123",
  "tags": ["技術", "教程"]
}
```

### 響應示例
```json
{
  "id": "post_456",
  "title": "我的第一篇文章",
  "slug": "my-first-post",
  "createdAt": "2024-01-15T10:00:00Z"
}
```

### 錯誤響應
| 狀態碼 | 錯誤碼 | 說明 |
|--------|--------|------|
| 400 | MISSING_TITLE | 標題不能爲空 |
| 400 | TITLE_TOO_LONG | 標題超過 100 字符 |
| 401 | UNAUTHORIZED | 未登錄 |
```

### URL 設計規範

```
✅ 好的設計
GET    /api/posts           # 獲取文章列表
GET    /api/posts/:id       # 獲取單篇文章
POST   /api/posts           # 創建文章
PUT    /api/posts/:id       # 更新文章
DELETE /api/posts/:id       # 刪除文章
GET    /api/posts/:id/comments  # 獲取文章的評論

❌ 不好的設計
GET    /api/getPostList     # 動詞不該出現在 URL
POST   /api/createPost      # 動詞重複
GET    /api/post/1/comment  # 單複數不一致
```

### 分頁與過濾

```markdown
## 列表接口通用參數

### 分頁
| 參數 | 類型 | 默認值 | 說明 |
|------|------|--------|------|
| page | number | 1 | 頁碼 |
| pageSize | number | 10 | 每頁數量 |

### 排序
| 參數 | 類型 | 說明 |
|------|------|------|
| sortBy | string | 排序字段 |
| order | "asc" \| "desc" | 排序方向 |

### 過濾
| 參數 | 類型 | 說明 |
|------|------|------|
| categoryId | string | 按分類篩選 |
| keyword | string | 關鍵詞搜索 |

### 響應格式
```json
{
  "data": [...],
  "pagination": {
    "page": 1,
    "pageSize": 10,
    "total": 100,
    "totalPages": 10
  }
}
```
```

### 讓 AI 幫你設計接口

```
你：幫我設計博客系統的 API 接口

AI：## 博客系統 API 設計

### 文章模塊
| 方法 | 路徑 | 說明 |
|------|------|------|
| GET | /api/posts | 獲取文章列表 |
| GET | /api/posts/:slug | 獲取文章詳情 |
| POST | /api/posts | 創建文章 |
| PUT | /api/posts/:id | 更新文章 |
| DELETE | /api/posts/:id | 刪除文章 |

### 分類模塊
| 方法 | 路徑 | 說明 |
|------|------|------|
| GET | /api/categories | 獲取分類列表 |
| POST | /api/categories | 創建分類 |

### 認證模塊
| 方法 | 路徑 | 說明 |
|------|------|------|
| POST | /api/auth/login | 登錄 |
| POST | /api/auth/logout | 登出 |
| GET | /api/auth/me | 獲取當前用戶 |
```

### 接口版本管理

當接口需要破壞性變更時：

```
方案一：URL 路徑版本
/api/v1/posts
/api/v2/posts

方案二：Header 版本
Accept: application/vnd.blog.v1+json
```

對於個人項目，建議使用 URL 路徑版本，更直觀。

### 實用建議

1. **保持一致性**：所有接口風格統一
2. **先設計後實現**：寫代碼前先把接口定義好
3. **用 AI 檢查**：讓 AI 幫你發現設計問題
4. **文檔即代碼**：用 TypeScript 類型定義接口
