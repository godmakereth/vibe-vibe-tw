---
title: "11.1.4 告訴大家更新了什麼——發佈公告：變更日誌與升級指南"
typora-root-url: ../../public
---

# 11.1.4 發佈公告：變更日誌與升級指南

## 一句話破題

**CHANGELOG**（變更日誌）記錄每個版本的變更內容，幫助用戶瞭解更新了什麼、是否需要升級、升級時需要注意什麼。

## 核心價值

維護 CHANGELOG 能讓你：
- 讓用戶快速瞭解版本變化
- 降低升級時的不確定性
- 建立可追溯的項目歷史

## CHANGELOG 格式規範

遵循 [Keep a Changelog](https://keepachangelog.com/) 規範：

```markdown
# Changelog

## [Unreleased]
### Added
- 新增用戶頭像上傳功能

## [1.2.0] - 2024-01-15
### Added
- 新增深色模式支持
- 新增多語言切換功能

### Changed
- 優化首頁加載速度

### Fixed
- 修復登錄頁面樣式問題

### Deprecated
- `getUserInfo` API 將在 2.0.0 版本移除

### Removed
- 移除廢棄的 `oldApi` 端點

### Security
- 修復 XSS 安全漏洞

## [1.1.0] - 2024-01-01
### Added
- 初始版本發佈
```

## 變更類型說明

| 類型 | 說明 | 示例 |
|------|------|------|
| `Added` | 新增功能 | 新增用戶註冊功能 |
| `Changed` | 功能變更 | 優化搜索算法 |
| `Deprecated` | 即將廢棄 | 該 API 將在下版本移除 |
| `Removed` | 已移除 | 移除舊版登錄接口 |
| `Fixed` | Bug 修復 | 修復日期顯示錯誤 |
| `Security` | 安全相關 | 修復權限繞過漏洞 |

## 快速上手

### 手動維護

每次提交時同步更新 `CHANGELOG.md`：

```bash
# 在 Unreleased 區域添加變更
echo "- 新增 XX 功能" >> CHANGELOG.md
git add CHANGELOG.md
git commit -m "docs: update changelog"
```

### 自動生成

使用工具從 Git 提交記錄生成：

```bash
# 安裝 conventional-changelog-cli
npm install -g conventional-changelog-cli

# 生成 CHANGELOG
conventional-changelog -p angular -i CHANGELOG.md -s
```

### 配合 npm version 使用

```json
{
  "scripts": {
    "version": "conventional-changelog -p angular -i CHANGELOG.md -s && git add CHANGELOG.md"
  }
}
```

這樣每次執行 `npm version` 時會自動更新 CHANGELOG。

## 升級指南

對於破壞性變更，需要提供詳細的升級指南：

```markdown
## 從 1.x 升級到 2.0

### 破壞性變更

#### 1. API 響應格式變更

**舊格式**:
```json
{ "data": [...], "total": 100 }
```

**新格式**:
```json
{ "items": [...], "pagination": { "total": 100 } }
```

**遷移方法**:
```typescript
// 舊代碼
const { data, total } = response

// 新代碼
const { items, pagination } = response
const { total } = pagination
```

#### 2. 環境變量重命名

| 舊名稱 | 新名稱 |
|--------|--------|
| `DB_URL` | `DATABASE_URL` |
| `API_KEY` | `NEXT_PUBLIC_API_KEY` |
```

## GitHub Release

除了 CHANGELOG，還可以在 GitHub 創建 Release：

```bash
# 使用 gh CLI 創建 Release
gh release create v1.2.0 \
  --title "v1.2.0" \
  --notes-file CHANGELOG.md \
  --latest
```

## 避坑指南

::: danger 新手最容易犯的錯
1. 只在發佈時才更新 CHANGELOG（應該隨代碼一起提交）
2. 變更描述太籠統（"修復了一些問題"沒有價值）
3. 破壞性變更沒有遷移指南
4. 忘記更新 Unreleased 區域
:::
