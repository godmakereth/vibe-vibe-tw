---
title: "4.4.1 Prisma 安裝配置：CLI 工具與依賴管理"
typora-root-url: ../../public
---

# 4.4.1 Prisma 安裝配置：CLI 工具與依賴管理

### 一句話破題

安裝 Prisma 只需兩步：安裝依賴 + 初始化配置。

### 安裝步驟

**1. 安裝依賴**

```bash
# 安裝 Prisma CLI（開發依賴）和 Prisma Client（運行時依賴）
npm install prisma --save-dev
npm install @prisma/client
```

| 包名 | 作用 | 環境 |
|------|------|------|
| `prisma` | CLI 工具（遷移、生成等） | 開發 |
| `@prisma/client` | 數據庫查詢客戶端 | 運行時 |

**2. 初始化項目**

```bash
npx prisma init
```

這會創建：
```
project/
├── prisma/
│   └── schema.prisma   # 數據模型定義
└── .env                # 數據庫連接配置
```

### schema.prisma 初始內容

```prisma
// 生成器配置：生成 Prisma Client
generator client {
  provider = "prisma-client-js"
}

// 數據源配置：數據庫連接
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
```

### .env 配置

```env
# PostgreSQL 連接字符串
DATABASE_URL="postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public"

# 示例：本地開發
DATABASE_URL="postgresql://postgres:password@localhost:5432/mydb?schema=public"

# 示例：Supabase
DATABASE_URL="postgresql://postgres:[PASSWORD]@db.[PROJECT].supabase.co:5432/postgres"
```

### 常用 CLI 命令

| 命令 | 作用 |
|------|------|
| `npx prisma init` | 初始化 Prisma 項目 |
| `npx prisma generate` | 生成 Prisma Client |
| `npx prisma migrate dev` | 創建並應用遷移 |
| `npx prisma db push` | 推送 Schema 到數據庫（無遷移） |
| `npx prisma studio` | 啓動可視化數據管理界面 |
| `npx prisma db seed` | 運行種子數據腳本 |

### 開發環境 vs 生產環境

| 場景 | 推薦數據庫 | 配置 |
|------|-----------|------|
| **本地開發** | SQLite | 簡單、無需安裝 |
| **團隊開發** | PostgreSQL（Docker） | 保持一致 |
| **生產環境** | PostgreSQL（雲服務） | Supabase/Neon |

**開發用 SQLite 配置**：
```prisma
datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}
```

### package.json 腳本配置

```json
{
  "scripts": {
    "db:generate": "prisma generate",
    "db:migrate": "prisma migrate dev",
    "db:push": "prisma db push",
    "db:studio": "prisma studio",
    "db:seed": "prisma db seed",
    "postinstall": "prisma generate"
  },
  "prisma": {
    "seed": "tsx prisma/seed.ts"
  }
}
```

`postinstall` 確保每次 `npm install` 後自動生成 Prisma Client。

### 驗證安裝

```bash
# 檢查 Prisma CLI 版本
npx prisma --version

# 啓動 Studio 驗證連接
npx prisma studio
```

### 本節小結

- 安裝 `prisma`（CLI）和 `@prisma/client`（運行時）
- `npx prisma init` 初始化項目
- 配置 `.env` 中的 `DATABASE_URL`
- 開發用 SQLite，生產用 PostgreSQL
